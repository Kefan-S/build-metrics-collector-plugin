<?jelly escape-by-default='true'?>
<j:jelly xmlns:j="jelly:core" xmlns:st="jelly:stapler" xmlns:x="jelly:xml">

  <st:contentType value="text/html;charset=UTF-8"/>
  <st:setHeader name="Expires" value="0" />
  <st:setHeader name="Cache-Control" value="no-cache,no-store,must-revalidate" />
  <x:doctype name="html" />
  <!DOCTYPE html>
  <html>
  <header>
    <meta charset="utf-8">
    <title>Opal</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@4.7.0/dist/echarts.min.js"></script>
  </header>
  <style>
    .opalChart{
      height: 400px;
      width: 600px;
      float: left;
    }
  </style>
  <body>
  <div>
    <div id="recoverTime" class="opalChart"></div>
    <div id="leadTime" class="opalChart"></div>
    <div id="deployFrequency" class="opalChart"></div>
    <div id="failureRate" class="opalChart"></div>
    <div id="avgDuration" class="opalChart"></div>
  </div>
  </body>
  <script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    var recoverTime = echarts.init(document.getElementById('recoverTime'));

    // 指定图表的配置项和数据
    var recoverTimeOption = {
      title: {
        text: 'Recover Time'
      },
      xAxis: {
        type: 'category',
        data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
      },
      yAxis: {
        type: 'value'
      },
      series: [{
        data: [820, 932, 901, 934, 1290, 1330, 1320],
        type: 'line',
        smooth: true
      }]
    };

    // 使用刚指定的配置项和数据显示图表。
    recoverTime.setOption(recoverTimeOption);


    // 基于准备好的dom，初始化echarts实例
    var leadTime = echarts.init(document.getElementById('leadTime'));

    // 指定图表的配置项和数据
    var leadTimeOption = {
      title: {
        text: 'Lead Time'
      },
      xAxis: {
        type: 'category',
        data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
      },
      yAxis: {
        type: 'value'
      },
      series: [{
        data: [820, 932, 901, 934, 1290, 1330, 1320],
        type: 'line',
        smooth: true
      }]
    };

    // 使用刚指定的配置项和数据显示图表。
    leadTime.setOption(leadTimeOption);


    // 基于准备好的dom，初始化echarts实例
    var avgDuration = echarts.init(document.getElementById('avgDuration'));

    // 指定图表的配置项和数据
    var avgDurationOption = {
      title: {
        text: 'Duration'
      },
      xAxis: {
        type: 'category',
        data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
      },
      yAxis: {
        type: 'value'
      },
      series: [{
        data: [820, 932, 901, 934, 1290, 1330, 1320],
        type: 'line',
        smooth: true
      }]
    };

    // 使用刚指定的配置项和数据显示图表。
    avgDuration.setOption(avgDurationOption);

    var failureRate = echarts.init(document.getElementById('failureRate'));

    failureRateOption = {
      title: {
        text: 'Failure Rate'
      },
      tooltip: {
        formatter: '{a} <br/>{b} : {c}%'
      },
      toolbox: {
        feature: {
          restore: {},
          saveAsImage: {}
        }
      },
      series: [
        {
          name: '业务指标',
          type: 'gauge',
          detail: {formatter: '{value}%'},
          data: [{value: 50, name: '失败率'}]
        }
      ]
    };

    setInterval(function () {
      failureRateOption.series[0].data[0].value = (Math.random() * 100).toFixed(2) - 0;
      failureRate.setOption(failureRateOption, true);
    }, 2000);


    var deployFrequency = echarts.init(document.getElementById('deployFrequency'));

    deployFrequencyOption = {
      title: {
        text: 'Deploy Frequency'
      },
      tooltip: {
        formatter: '{a} <br/>{b} : {c}%'
      },
      toolbox: {
        feature: {
          restore: {},
          saveAsImage: {}
        }
      },
      series: [
        {
          name: '业务指标',
          type: 'gauge',
          detail: {formatter: '{value}'},
          data: [{value: 50, name: '部署频率'}]
        }
      ]
    };

    setInterval(function () {
      deployFrequencyOption.series[0].data[0].value = (Math.random() * 100).toFixed(2) - 0;
      deployFrequency.setOption(deployFrequencyOption, true);
    }, 2000);
  </script>
  </html>
</j:jelly>
